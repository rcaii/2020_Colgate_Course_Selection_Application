import { __decorate, __metadata } from "tslib";
import { Component, Input, Output, EventEmitter } from '@angular/core';
import { IconHandler } from '../core/util/icon';
import * as util from './util';
var NoticeBarComponent = /** @class */ (function () {
    function NoticeBarComponent(_iconHandler) {
        this._iconHandler = _iconHandler;
        this.visiable = false;
        this.marqueeScroll = 'scrolling';
        this.style = {};
        this._option = {
            mode: '',
            icon: '',
            action: '',
            content: '',
            fontSize: '14px',
            scrolling: true,
            marqueeProps: { loop: true, leading: 500, trailing: 8000, fps: 200, style: {} }
        };
        this.onClick = new EventEmitter();
        this._iconHandler.load();
    }
    Object.defineProperty(NoticeBarComponent.prototype, "option", {
        get: function () {
            return this._option;
        },
        set: function (value) {
            Object.assign(this._option, value);
            this.dataProcess();
            if (this._option.scrolling) {
                this.marqueeScroll = 'scrolling';
            }
            else {
                this.marqueeScroll = 'scrolling-stop';
            }
        },
        enumerable: true,
        configurable: true
    });
    NoticeBarComponent.prototype.click = function () {
        this.onClick.emit(this._option.mode);
        if (this._option.mode === 'closable') {
            this.visiable = false;
        }
    };
    NoticeBarComponent.prototype.dataProcess = function () {
        this.visiable = true;
        this.style = {
            width: '200%'
        };
        this._width = util.getTextWidth(this._option.content, this._option.fontSize);
        if (util.getWidthHeight().width < this._width) {
            var count = this._option.marqueeProps.loop ? 'infinite' : 1;
            var animationName = "noticebarmarquee_" + this._width;
            this.style = {
                width: this._width * 2 + 'px',
                'animation-name': animationName,
                'animation-delay': this._option.marqueeProps.leading + "ms",
                'animation-duration': (((1 / this._option.marqueeProps.fps) * this._width) / util.getWidthHeight().width) *
                    1000 + "s",
                'animation-iteration-count': "" + count
            };
            this.marqueeScroll = 'scrolling';
            this.insetKeyframe(animationName);
        }
        else {
            this.marqueeScroll = 'scrolling-stop';
        }
    };
    NoticeBarComponent.prototype.insetKeyframe = function (animationName) {
        util.insertKeyFrame("@keyframes " + animationName + " {\n      0% { left: 0px; }\n      100% { left: -" + this._width + "px }\n    }", 'notice_bar_animation_cls');
        util.insertKeyFrame("@-webkit-keyframes " + animationName + " {\n      0% { left: 0px; }\n      100% { left: -" + this._width + "px }\n    }", 'notice_bar_animation_cls');
        util.insertKeyFrame("@-moz-keyframes " + animationName + " {\n      0% { left: 0px; }\n      100% { left: -" + this._width + "px }\n    }", 'notice_bar_animation_cls');
        util.insertKeyFrame("@-o-keyframes " + animationName + " {\n      0% { left: 0px; }\n      100% { left: -" + this._width + "px }\n    }", 'notice_bar_animation_cls');
    };
    NoticeBarComponent.prototype.ngOnInit = function () {
        var _this = this;
        document.addEventListener('touchstart', function () {
            _this.marqueeScroll = 'scrolling-stop';
        });
        document.addEventListener('touchend', function () {
            _this.marqueeScroll = 'scrolling';
        });
    };
    NoticeBarComponent.prototype.ngOnDestroy = function () {
        util.deleteKeyFrame('notice_bar_animation_cls');
    };
    NoticeBarComponent.ctorParameters = function () { return [
        { type: IconHandler }
    ]; };
    __decorate([
        Input(),
        __metadata("design:type", Object),
        __metadata("design:paramtypes", [Object])
    ], NoticeBarComponent.prototype, "option", null);
    __decorate([
        Output(),
        __metadata("design:type", EventEmitter)
    ], NoticeBarComponent.prototype, "onClick", void 0);
    NoticeBarComponent = __decorate([
        Component({
            selector: 'NoticeBar, nzm-notice-bar',
            template: "<div role=\"alert\" *ngIf=\"visiable\" class=\"am-notice-bar\" (click)=\"click()\">\n  <div *ngIf=\"option.icon !== null\" class=\"am-notice-bar-icon\">\n    <ng-template [ngTemplateOutlet]=\"option.icon || voice\"></ng-template>\n  </div>\n  <div class=\"am-notice-bar-content\">\n    <div class=\"marquee\">\n      <div [ngClass]=\"marqueeScroll\" [ngStyle]=\"style\">\n        <span>{{ option.content }}</span>\n        <span>{{ option.content }}</span>\n      </div>\n    </div>\n  </div>\n  <div role=\"button\" *ngIf=\"option.mode && option.action !== null\" class=\"am-notice-bar-operation\">\n    <ng-template *ngIf=\"option.mode === 'closable'\" [ngTemplateOutlet]=\"option.action || cross\"></ng-template>\n    <ng-template *ngIf=\"option.mode === 'link'\" [ngTemplateOutlet]=\"option.action || right\"></ng-template>\n  </div>\n</div>\n\n<ng-template #voice>\n  <Icon [type]=\"'voice'\" [size]=\"'xxs'\"></Icon>\n</ng-template>\n<ng-template #cross>\n  <Icon [type]=\"'cross'\" [size]=\"'md'\"></Icon>\n</ng-template>\n<ng-template #right>\n  <Icon [type]=\"'right'\" [size]=\"'md'\"></Icon>\n</ng-template>\n",
            providers: [IconHandler]
        }),
        __metadata("design:paramtypes", [IconHandler])
    ], NoticeBarComponent);
    return NoticeBarComponent;
}());
export { NoticeBarComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm90aWNlLWJhci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZy16b3Jyby1hbnRkLW1vYmlsZS8iLCJzb3VyY2VzIjpbIm5vdGljZS1iYXIvbm90aWNlLWJhci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQVUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQWEsTUFBTSxlQUFlLENBQUM7QUFDMUYsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBQ2hELE9BQU8sS0FBSyxJQUFJLE1BQU0sUUFBUSxDQUFDO0FBTS9CO0lBOEJFLDRCQUFvQixZQUF5QjtRQUF6QixpQkFBWSxHQUFaLFlBQVksQ0FBYTtRQTdCN0MsYUFBUSxHQUFHLEtBQUssQ0FBQztRQUNqQixrQkFBYSxHQUFHLFdBQVcsQ0FBQztRQUM1QixVQUFLLEdBQUcsRUFBRSxDQUFDO1FBRUgsWUFBTyxHQUFHO1lBQ2hCLElBQUksRUFBRSxFQUFFO1lBQ1IsSUFBSSxFQUFFLEVBQUU7WUFDUixNQUFNLEVBQUUsRUFBRTtZQUNWLE9BQU8sRUFBRSxFQUFFO1lBQ1gsUUFBUSxFQUFFLE1BQU07WUFDaEIsU0FBUyxFQUFFLElBQUk7WUFDZixZQUFZLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUU7U0FDaEYsQ0FBQztRQWVGLFlBQU8sR0FBc0IsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUc5QyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFqQkQsc0JBQUksc0NBQU07YUFBVjtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUN0QixDQUFDO2FBQ0QsVUFBVyxLQUFLO1lBQ2QsTUFBTSxDQUFDLE1BQU0sQ0FB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QUFFO1lBQ3RDLEtBQUksQ0FBQyxhQUFhLEdBQUcsZ0JBQWdCLENBQUM7UUFDeEMsQ0FBQyxDQUFDLENBQUM7UUFFSCxRQUFRLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxFQUFFO1lBQ3BDLEtBQUksQ0FBQyxhQUFhLEdBQUcsV0FBVyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELHdDQUFXLEdBQVg7UUFDRSxJQUFJLENBQUMsY0FBYyxDQUFDLDBCQUEwQixDQUFDLENBQUM7SUFDbEQsQ0FBQzs7Z0JBOUVpQyxXQUFXOztJQWY3QztRQURDLEtBQUssRUFBRTs7O29EQUdQO0lBV0Q7UUFEQyxNQUFNLEVBQUU7a0NBQ0EsWUFBWTt1REFBMkI7SUE1QnJDLGtCQUFrQjtRQUw5QixTQUFTLENBQUM7WUFDVCxRQUFRLEVBQUUsMkJBQTJCO1lBQ3JDLDRtQ0FBMEM7WUFDMUMsU0FBUyxFQUFFLENBQUMsV0FBVyxDQUFDO1NBQ3pCLENBQUM7eUNBK0JrQyxXQUFXO09BOUJsQyxrQkFBa0IsQ0E2RzlCO0lBQUQseUJBQUM7Q0FBQSxBQTdHRCxJQTZHQztTQTdHWSxrQkFBa0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgSW5wdXQsIE91dHB1dCwgRXZlbnRFbWl0dGVyLCBPbkRlc3Ryb3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEljb25IYW5kbGVyIH0gZnJvbSAnLi4vY29yZS91dGlsL2ljb24nO1xuaW1wb3J0ICogYXMgdXRpbCBmcm9tICcuL3V0aWwnO1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnTm90aWNlQmFyLCBuem0tbm90aWNlLWJhcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9ub3RpY2UtYmFyLmNvbXBvbmVudC5odG1sJyxcbiAgcHJvdmlkZXJzOiBbSWNvbkhhbmRsZXJdXG59KVxuZXhwb3J0IGNsYXNzIE5vdGljZUJhckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgdmlzaWFibGUgPSBmYWxzZTtcbiAgbWFycXVlZVNjcm9sbCA9ICdzY3JvbGxpbmcnO1xuICBzdHlsZSA9IHt9O1xuICBwcml2YXRlIF93aWR0aDtcbiAgcHJpdmF0ZSBfb3B0aW9uID0ge1xuICAgIG1vZGU6ICcnLFxuICAgIGljb246ICcnLFxuICAgIGFjdGlvbjogJycsXG4gICAgY29udGVudDogJycsXG4gICAgZm9udFNpemU6ICcxNHB4JyxcbiAgICBzY3JvbGxpbmc6IHRydWUsXG4gICAgbWFycXVlZVByb3BzOiB7IGxvb3A6IHRydWUsIGxlYWRpbmc6IDUwMCwgdHJhaWxpbmc6IDgwMDAsIGZwczogMjAwLCBzdHlsZToge30gfVxuICB9O1xuICBASW5wdXQoKVxuICBnZXQgb3B0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLl9vcHRpb247XG4gIH1cbiAgc2V0IG9wdGlvbih2YWx1ZSkge1xuICAgIE9iamVjdC5hc3NpZ24odGhpcy5fb3B0aW9uLCB2YWx1ZSk7XG4gICAgdGhpcy5kYXRhUHJvY2VzcygpO1xuICAgIGlmICh0aGlzLl9vcHRpb24uc2Nyb2xsaW5nKSB7XG4gICAgICB0aGlzLm1hcnF1ZWVTY3JvbGwgPSAnc2Nyb2xsaW5nJztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tYXJxdWVlU2Nyb2xsID0gJ3Njcm9sbGluZy1zdG9wJztcbiAgICB9XG4gIH1cbiAgQE91dHB1dCgpXG4gIG9uQ2xpY2s6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgX2ljb25IYW5kbGVyOiBJY29uSGFuZGxlcikge1xuICAgIHRoaXMuX2ljb25IYW5kbGVyLmxvYWQoKTtcbiAgfVxuXG4gIGNsaWNrKCkge1xuICAgIHRoaXMub25DbGljay5lbWl0KHRoaXMuX29wdGlvbi5tb2RlKTtcbiAgICBpZiAodGhpcy5fb3B0aW9uLm1vZGUgPT09ICdjbG9zYWJsZScpIHtcbiAgICAgIHRoaXMudmlzaWFibGUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBkYXRhUHJvY2VzcygpIHtcbiAgICB0aGlzLnZpc2lhYmxlID0gdHJ1ZTtcbiAgICB0aGlzLnN0eWxlID0ge1xuICAgICAgd2lkdGg6ICcyMDAlJ1xuICAgIH07XG4gICAgdGhpcy5fd2lkdGggPSB1dGlsLmdldFRleHRXaWR0aCh0aGlzLl9vcHRpb24uY29udGVudCwgdGhpcy5fb3B0aW9uLmZvbnRTaXplKTtcbiAgICBpZiAodXRpbC5nZXRXaWR0aEhlaWdodCgpLndpZHRoIDwgdGhpcy5fd2lkdGgpIHtcbiAgICAgIGNvbnN0IGNvdW50ID0gdGhpcy5fb3B0aW9uLm1hcnF1ZWVQcm9wcy5sb29wID8gJ2luZmluaXRlJyA6IDE7XG4gICAgICBsZXQgYW5pbWF0aW9uTmFtZSA9IGBub3RpY2ViYXJtYXJxdWVlXyR7dGhpcy5fd2lkdGh9YDtcbiAgICAgIHRoaXMuc3R5bGUgPSB7XG4gICAgICAgIHdpZHRoOiB0aGlzLl93aWR0aCAqIDIgKyAncHgnLFxuICAgICAgICAnYW5pbWF0aW9uLW5hbWUnOiBhbmltYXRpb25OYW1lLFxuICAgICAgICAnYW5pbWF0aW9uLWRlbGF5JzogYCR7dGhpcy5fb3B0aW9uLm1hcnF1ZWVQcm9wcy5sZWFkaW5nfW1zYCxcbiAgICAgICAgJ2FuaW1hdGlvbi1kdXJhdGlvbic6IGAkeygoKDEgLyB0aGlzLl9vcHRpb24ubWFycXVlZVByb3BzLmZwcykgKiB0aGlzLl93aWR0aCkgLyB1dGlsLmdldFdpZHRoSGVpZ2h0KCkud2lkdGgpICpcbiAgICAgICAgICAxMDAwfXNgLFxuICAgICAgICAnYW5pbWF0aW9uLWl0ZXJhdGlvbi1jb3VudCc6IGAke2NvdW50fWBcbiAgICAgIH07XG4gICAgICB0aGlzLm1hcnF1ZWVTY3JvbGwgPSAnc2Nyb2xsaW5nJztcbiAgICAgIHRoaXMuaW5zZXRLZXlmcmFtZShhbmltYXRpb25OYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tYXJxdWVlU2Nyb2xsID0gJ3Njcm9sbGluZy1zdG9wJztcbiAgICB9XG4gIH1cblxuICBpbnNldEtleWZyYW1lKGFuaW1hdGlvbk5hbWUpIHtcbiAgICB1dGlsLmluc2VydEtleUZyYW1lKFxuICAgICAgYEBrZXlmcmFtZXMgJHthbmltYXRpb25OYW1lfSB7XG4gICAgICAwJSB7IGxlZnQ6IDBweDsgfVxuICAgICAgMTAwJSB7IGxlZnQ6IC0ke3RoaXMuX3dpZHRofXB4IH1cbiAgICB9YCxcbiAgICAgICdub3RpY2VfYmFyX2FuaW1hdGlvbl9jbHMnXG4gICAgKTtcbiAgICB1dGlsLmluc2VydEtleUZyYW1lKFxuICAgICAgYEAtd2Via2l0LWtleWZyYW1lcyAke2FuaW1hdGlvbk5hbWV9IHtcbiAgICAgIDAlIHsgbGVmdDogMHB4OyB9XG4gICAgICAxMDAlIHsgbGVmdDogLSR7dGhpcy5fd2lkdGh9cHggfVxuICAgIH1gLFxuICAgICAgJ25vdGljZV9iYXJfYW5pbWF0aW9uX2NscydcbiAgICApO1xuICAgIHV0aWwuaW5zZXJ0S2V5RnJhbWUoXG4gICAgICBgQC1tb3ota2V5ZnJhbWVzICR7YW5pbWF0aW9uTmFtZX0ge1xuICAgICAgMCUgeyBsZWZ0OiAwcHg7IH1cbiAgICAgIDEwMCUgeyBsZWZ0OiAtJHt0aGlzLl93aWR0aH1weCB9XG4gICAgfWAsXG4gICAgICAnbm90aWNlX2Jhcl9hbmltYXRpb25fY2xzJ1xuICAgICk7XG4gICAgdXRpbC5pbnNlcnRLZXlGcmFtZShcbiAgICAgIGBALW8ta2V5ZnJhbWVzICR7YW5pbWF0aW9uTmFtZX0ge1xuICAgICAgMCUgeyBsZWZ0OiAwcHg7IH1cbiAgICAgIDEwMCUgeyBsZWZ0OiAtJHt0aGlzLl93aWR0aH1weCB9XG4gICAgfWAsXG4gICAgICAnbm90aWNlX2Jhcl9hbmltYXRpb25fY2xzJ1xuICAgICk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKCkgPT4ge1xuICAgICAgdGhpcy5tYXJxdWVlU2Nyb2xsID0gJ3Njcm9sbGluZy1zdG9wJztcbiAgICB9KTtcblxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgKCkgPT4ge1xuICAgICAgdGhpcy5tYXJxdWVlU2Nyb2xsID0gJ3Njcm9sbGluZyc7XG4gICAgfSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB1dGlsLmRlbGV0ZUtleUZyYW1lKCdub3RpY2VfYmFyX2FuaW1hdGlvbl9jbHMnKTtcbiAgfVxufVxuIl19